{"version":3,"sources":["/Users/ashar61/work/projects/easy-node-authentication/app/routes.js"],"names":[],"mappings":"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","file":"routes-compiled.js","sourcesContent":["let Twitter = require(\"twitter\")\nfunction isLoggedIn(req, res, next) {\n    if (req.isAuthenticated())\n        return next()\n\n    res.redirect(\"/\")\n}\n\nmodule.exports = function (app, passport) {\n    var posts = require('../data/posts')\n\n    app.get(\"/\", function (req, res) {\n        res.render(\"index.ejs\")\n    })\n\n\n\n    app.get(\"/profile\", isLoggedIn, function (req, res) {\n        res.render(\"profile.ejs\", {\n            user: req.user\n        })\n    })\n\n    app.get(\"/logout\", function (req, res) {\n        req.logout()\n        res.redirect(\"/\")\n    })\n\n    app.get(\"/login\", function (req, res) {\n        res.render(\"login.ejs\", {message: req.flash(\"loginMessage\")})\n    })\n\n    app.post(\"/login\", passport.authenticate(\"local-login\", {\n        successRedirect: \"/profile\", // redirect to the secure profile section\n        failureRedirect: \"/login\", // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }))\n\n\n    app.get(\"/signup\", function (req, res) {\n        res.render(\"signup.ejs\", {message: req.flash(\"signupMessage\")})\n    })\n\n    app.post(\"/signup\", passport.authenticate(\"local-signup\", {\n        successRedirect: \"/profile\", // redirect to the secure profile section\n        failureRedirect: \"/signup\", // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }))\n\n    app.get(\"/auth/facebook\", passport.authenticate(\"facebook\", {scope: \"email\"}))\n\n\n    app.get(\"/auth/facebook/callback\",\n        passport.authenticate(\"facebook\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n    // send to twitter to do the authentication\n    app.get(\"/auth/twitter\", passport.authenticate(\"twitter\", {scope: \"email\"}))\n\n\n    app.get(\"/auth/twitter/callback\",\n        passport.authenticate(\"twitter\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n\n    app.get(\"/auth/google\", passport.authenticate(\"google\", {scope: [\"profile\", \"email\"]}))\n\n\n    app.get(\"/auth/google/callback\",\n        passport.authenticate(\"google\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n    app.get(\"/connect/local\", function (req, res) {\n        res.render(\"connect-local.ejs\", {message: req.flash(\"loginMessage\")})\n    })\n    app.post(\"/connect/local\", passport.authenticate(\"local-signup\", {\n        successRedirect: \"/profile\", // redirect to the secure profile section\n        failureRedirect: \"/connect/local\", // redirect back to the signup page if there is an error\n        failureFlash: true // allow flash messages\n    }))\n\n    app.get(\"/connect/facebook\", passport.authorize(\"facebook\", {scope: \"email\"}))\n\n    app.get(\"/connect/facebook/callback\",\n        passport.authorize(\"facebook\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n    app.get(\"/connect/twitter\", passport.authorize(\"twitter\", {scope: \"email\"}))\n\n    app.get(\"/connect/twitter/callback\",\n        passport.authorize(\"twitter\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n\n    // google ---------------------------------\n\n    // send to google to do the authentication\n    app.get(\"/connect/google\", passport.authorize(\"google\", {scope: [\"profile\", \"email\"]}))\n\n    // the callback after google has authorized the user\n    app.get(\"/connect/google/callback\",\n        passport.authorize(\"google\", {\n            successRedirect: \"/profile\",\n            failureRedirect: \"/\"\n        }))\n\n    app.get(\"/unlink/local\", isLoggedIn, function (req, res) {\n        var user = req.user\n        user.local.email = undefined\n        user.local.password = undefined\n        user.save(function (err) {\n            res.redirect(\"/profile\")\n        })\n    })\n\n    // facebook -------------------------------\n    app.get(\"/unlink/facebook\", isLoggedIn, function (req, res) {\n        var user = req.user\n        user.facebook.token = undefined\n        user.save(function (err) {\n            res.redirect(\"/profile\")\n        })\n    })\n\n    // twitter --------------------------------\n    app.get(\"/unlink/twitter\", isLoggedIn, function (req, res) {\n        var user = req.user\n        user.twitter.token = undefined\n        user.save(function (err) {\n            res.redirect(\"/profile\")\n        })\n    })\n\n    // google ---------------------------------\n    app.get(\"/unlink/google\", isLoggedIn, function (req, res) {\n        var user = req.user\n        user.google.token = undefined\n        user.save(function (err) {\n            res.redirect(\"/profile\")\n        })\n    })\n\n    app.get(\"/timeline\", isLoggedIn, function (req, res) {\n        var twitter = new Twitter({\n            consumer_key: app.config.auth.twitterAuth.clientID,\n            consumer_secret: app.config.auth.twitterAuth.clientSecret,\n            access_token_key: req.user.twitter.token,\n            access_token_secret: req.user.twitter.secret\n        })\n\n        twitter.map\n\n        res.render(\"timeline.ejs\", {\n            posts: posts\n        })\n    })\n\n}\n\n\n"]}